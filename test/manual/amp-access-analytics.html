<!doctype html>
<html âš¡>
  <head>
    <meta charset="utf-8">
    <title>AMP Access Analytics Visibility</title>
    <link rel="canonical" href="amps.html">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Questrial" rel="stylesheet" type="text/css">
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
      <script async src="https://cdn.ampproject.org/v0.js"></script>

      <script async custom-element="amp-access" src="https://cdn.ampproject.org/v0/amp-access-0.1.js"></script>
      <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>

      <style amp-custom>

        body {
          padding: 10px;
        }

        section {
          padding: 10px;
          margin: 10px;
          border: 2px solid #000;
        }
      </style>
  </head>

  <body>

    <amp-analytics>
      <script type="application/json">
        {
          "requests": {
            "pageview": "/analytics/pageview",
            "paywallvisible": "/analytics/paywallvisible"
          },
          "triggers": {
            "pageview": {
              "on": "visible",
              "request": "pageview"
            },
            "accessPaywall": {
              "on": "visible",
              "request": "paywallvisible",
              "selector": "#access-paywall"
            }
          },
          "transport": {
            "referrerPolicy": "no-referrer"
          }
        }
      </script>
    </amp-analytics>

    <script id="amp-access" type="application/json">
      {
        "authorization": "/access/authorization?rid=READER_ID&url=CANONICAL_URL&ref=DOCUMENT_REFERRER&_=RANDOM",
        "noPingback": true,
        "login": {
          "sign-in": "/access/login?rid=READER_ID&url=CANONICAL_URL",
          "sign-out": "/access/logout"
        },
        "authorizationFallbackResponse": {
          "loggedIn": false,
          "subscriber": false
        }
      }
    </script>


    <h2>AMP Access Analytics Visibility</h2>
    <p>See: <a href="https://github.com/ampproject/amphtml/issues/19030" target="_blank">#19030 on Github</a></p>

    <section>
      <div>Welcome to the website! This section is visible to all.</div>
    </section>

    <section amp-access="NOT subscriber">
      <div>This section is only visible if you're not a subscriber.</div>
      <div>See the amp-access "paywall" element below</div>
      <amp-img id="access-paywall"
        layout="fixed"
        width="100px"
        height="100px"
        alt="Example paywall amp element"
        src="https://www.ampproject.org/static/img/home/home_icon_performance.svg"></amp-img>
      <div>You must <a href="/access/subscribe" target="_blank">subscribe</a></div>
    </section>

  </body>
</html>
